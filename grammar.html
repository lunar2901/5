<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>German Grammar A1‚ÄìC2</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üá©üá™</text></svg>">

  <!-- Page-only layout helpers (works even if style.css is minimal) -->
  <style>
    :root{
      --panel: rgba(0,0,0,.04);
      --border: rgba(0,0,0,.10);
      --muted: rgba(0,0,0,.70);
      --radius: 14px;
    }

    .grammar-shell{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 1rem;
      align-items:start;
    }
    @media (max-width: 960px){
      .grammar-shell{ grid-template-columns: 1fr; }
      .sidebar{ position: static !important; }
    }

    .sidebar{
      position: sticky;
      top: 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: white;
      padding: 1rem;
    }

    .sidebar h3{ margin: 0 0 .75rem; }
    .sidebar .group{ margin-top: 1rem; }
    .sidebar .pill{
      display:inline-block;
      padding:.25rem .55rem;
      border-radius: 999px;
      border:1px solid var(--border);
      margin:.2rem .25rem .2rem 0;
      font-size:.85rem;
      cursor:pointer;
      user-select:none;
    }
    .sidebar .pill.active{
      border-color: rgba(0,0,0,.35);
      font-weight: 700;
    }

    .topic-links{
      margin-top: .5rem;
      display:flex;
      flex-direction:column;
      gap:.35rem;
      max-height: 45vh;
      overflow:auto;
      padding-right:.25rem;
    }
    .topic-links a{
      text-decoration:none;
      opacity:.95;
      padding:.35rem .5rem;
      border-radius: 10px;
      border:1px solid transparent;
    }
    .topic-links a:hover{
      background: var(--panel);
      border-color: var(--border);
    }
    .topic-links .muted{ color: var(--muted); font-size: .9rem; }

    .content-area{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: white;
      padding: 1rem;
    }

    .controls{
      display:flex;
      gap:.75rem;
      flex-wrap:wrap;
      align-items:center;
      padding: .75rem;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel);
      margin-bottom: 1rem;
    }
    .controls label{ font-size:.9rem; color:var(--muted); }
    .controls input[type="search"]{
      flex: 1 1 260px;
      padding:.6rem .75rem;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: white;
      outline: none;
    }
    .controls select{
      padding:.55rem .65rem;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: white;
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:.45rem;
      padding:.4rem .6rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: white;
      user-select:none;
    }
    .toggle input{ transform: translateY(1px); }

    .topic-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: .85rem;
    }

    .topic-card{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: .95rem;
      background: white;
    }

    .topic-head{
      display:flex;
      justify-content:space-between;
      gap: .75rem;
      align-items:flex-start;
    }

    .topic-title{
      margin:0;
      font-size:1.05rem;
      line-height:1.25;
    }
    .topic-meta{
      display:flex;
      gap:.35rem;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }
    .tag{
      display:inline-block;
      padding:.2rem .5rem;
      border-radius:999px;
      border:1px solid var(--border);
      font-size:.8rem;
      white-space:nowrap;
    }

    .topic-summary{
      margin:.55rem 0 0;
      color: var(--muted);
    }

    details{
      margin-top:.75rem;
      border-top: 1px dashed var(--border);
      padding-top:.6rem;
    }
    details > summary{
      cursor:pointer;
      font-weight:700;
      list-style:none;
    }
    details > summary::-webkit-details-marker{ display:none; }

    .example-box, .tip-box{
      margin-top:.6rem;
      padding:.75rem;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--panel);
    }
    .tip-box strong{ display:inline-block; margin-right:.25rem; }

    .grammar-table, .mini-table{
      width:100%;
      border-collapse:collapse;
      margin-top:.6rem;
      overflow:hidden;
      border-radius: 12px;
    }
    .grammar-table th, .grammar-table td,
    .mini-table th, .mini-table td{
      border:1px solid var(--border);
      padding:.55rem;
      vertical-align:top;
    }

    .empty-state{
      display:none;
      padding: 1.25rem;
      border: 1px dashed var(--border);
      border-radius: var(--radius);
      background: rgba(0,0,0,.02);
      color: var(--muted);
      text-align:center;
    }

    /* JS toggles */
    .hide-examples .examples { display:none !important; }
    .hide-details  .deepdive { display:none !important; }
  </style>
</head>

<body>
  <!-- Your existing header (unchanged) -->
  <header class="main-header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="40" height="13.33" fill="#000"/>
            <rect y="13.33" width="40" height="13.33" fill="#DD0000"/>
            <rect y="26.67" width="40" height="13.33" fill="#FFCE00"/>
          </svg>
          <h1>German Verbs</h1>
        </div>

        <nav class="main-nav">
          <a href="index.html" class="nav-link">Verbs</a>
          <a href="nouns.html" class="nav-link">Nouns</a>
          <a href="adjectives.html" class="nav-link">Adjectives</a>
          <a href="adverbs.html" class="nav-link">Adverbs</a>
          <a href="practice.html" class="nav-link">Practice</a>
          <a href="grammar.html" class="nav-link active">Grammar</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="main-content grammar-page">
    <div class="container">

      <section class="grammar-header">
        <h2>German Grammar (A1‚ÄìC2)</h2>
        <p>Filter by level, search topics, and expand only what you need.</p>
      </section>

      <div class="grammar-shell" id="grammarApp">

        <!-- SIDEBAR -->
        <aside class="sidebar">
          <h3>Focus</h3>

          <div class="group">
            <div class="muted" style="margin-bottom:.4rem;">Level</div>
            <div id="levelPills">
              <span class="pill active" data-level="ALL">All</span>
              <span class="pill" data-level="A1">A1</span>
              <span class="pill" data-level="A2">A2</span>
              <span class="pill" data-level="B1">B1</span>
              <span class="pill" data-level="B2">B2</span>
              <span class="pill" data-level="C1">C1</span>
              <span class="pill" data-level="C2">C2</span>
            </div>
          </div>

          <div class="group">
            <div class="muted">Jump to topic</div>
            <div class="topic-links" id="topicLinks">
              <!-- auto-filled by JS -->
            </div>
          </div>

          <div class="group">
            <div class="muted">Tip</div>
            <p class="muted" style="margin:.35rem 0 0;">
              Start with <strong>A1 ‚Üí Word Order</strong>, then <strong>Cases</strong>, then <strong>Subordinate clauses</strong>.
            </p>
          </div>
        </aside>

        <!-- MAIN CONTENT -->
        <section class="content-area">

          <!-- CONTROLS -->
          <div class="controls">
            <label for="searchBox">Search</label>
            <input id="searchBox" type="search" placeholder="Type a topic‚Ä¶ (e.g., dative, weil, passive, Konjunktiv)" />

            <label for="levelSelect">Level</label>
            <select id="levelSelect">
              <option value="ALL">All levels</option>
              <option value="A1">A1</option>
              <option value="A2">A2</option>
              <option value="B1">B1</option>
              <option value="B2">B2</option>
              <option value="C1">C1</option>
              <option value="C2">C2</option>
            </select>

            <label class="toggle" title="Hide/show example sections">
              <input id="toggleExamples" type="checkbox" />
              Hide examples
            </label>

            <label class="toggle" title="Hide/show deep-dive sections">
              <input id="toggleDetails" type="checkbox" />
              Hide deep dives
            </label>

            <button class="toggle" id="resetBtn" type="button" title="Reset filters" style="cursor:pointer;">
              Reset
            </button>
          </div>

          <div class="empty-state" id="emptyState">
            No topics match your filters. Try clearing the search or choosing ‚ÄúAll levels‚Äù.
          </div>

          <!-- TOPIC CARDS -->
          <div class="topic-grid" id="topicGrid">

            <!-- A1 -->
            <article class="topic-card topic" id="t-v2" data-level="A1" data-tags="word order v2 main clause questions negation">
              <div class="topic-head">
                <h4 class="topic-title">Verb-Second (V2) in Main Clauses</h4>
                <div class="topic-meta">
                  <span class="tag">A1</span>
                  <span class="tag">Word order</span>
                </div>
              </div>
              <p class="topic-summary">
                In a main clause, the conjugated verb is in position 2. Position 1 can be the subject or any other element.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Ich <strong>gehe</strong> heute ins Kino.</p>
                  <p>Heute <strong>gehe</strong> ich ins Kino.</p>
                  <p><strong>Gehst</strong> du heute ins Kino?</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Negation:</strong> <em>nicht</em> negates verbs/phrases; <em>kein</em> negates nouns with no article.
                </div>
                <div class="example-box">
                  <p>Ich komme <strong>nicht</strong>.</p>
                  <p>Ich habe <strong>kein</strong> Auto.</p>
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-cases-basic" data-level="A1" data-tags="cases nominative accusative articles pronouns">
              <div class="topic-head">
                <h4 class="topic-title">Cases: Nominative & Accusative</h4>
                <div class="topic-meta">
                  <span class="tag">A1</span>
                  <span class="tag">Cases</span>
                </div>
              </div>
              <p class="topic-summary">
                Nominative is usually the subject; accusative is the direct object. Articles change (der ‚Üí den).
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p><strong>Der</strong> Mann sieht <strong>den</strong> Hund.</p>
                  <p><strong>Die</strong> Frau kauft <strong>das</strong> Brot.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <table class="grammar-table">
                  <tr><th></th><th>der</th><th>die</th><th>das</th><th>plural</th></tr>
                  <tr><td><strong>Nominative</strong></td><td>der</td><td>die</td><td>das</td><td>die</td></tr>
                  <tr><td><strong>Accusative</strong></td><td>den</td><td>die</td><td>das</td><td>die</td></tr>
                </table>
              </details>
            </article>

            <!-- A2 -->
            <article class="topic-card topic" id="t-perfekt" data-level="A2" data-tags="past tense perfekt haben sein participle partizip">
              <div class="topic-head">
                <h4 class="topic-title">Perfekt (Spoken Past): haben/sein + Partizip II</h4>
                <div class="topic-meta">
                  <span class="tag">A2</span>
                  <span class="tag">Tenses</span>
                </div>
              </div>
              <p class="topic-summary">
                The most common spoken past tense: auxiliary in position 2 and participle at the end.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Ich <strong>habe</strong> Pizza <strong>gegessen</strong>.</p>
                  <p>Ich <strong>bin</strong> nach Hause <strong>gegangen</strong>.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Use ‚Äúsein‚Äù</strong> with movement/change of state (gehen, kommen, fahren, einschlafen, werden‚Ä¶).
                </div>
                <div class="example-box">
                  <p><strong>Regular:</strong> machen ‚Üí gemacht</p>
                  <p><strong>Irregular:</strong> gehen ‚Üí gegangen</p>
                  <p><strong>Inseparable:</strong> besuchen ‚Üí besucht (no ‚Äúge-‚Äù)</p>
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-dative" data-level="A2" data-tags="dative wem verbs helfen gefallen prepositions">
              <div class="topic-head">
                <h4 class="topic-title">Dative (Wem?) + Common Dative Verbs</h4>
                <div class="topic-meta">
                  <span class="tag">A2</span>
                  <span class="tag">Cases</span>
                </div>
              </div>
              <p class="topic-summary">
                Dative marks the indirect object and is required by many verbs/prepositions (helfen, danken, mit, zu‚Ä¶).
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Ich gebe <strong>dem</strong> Mann das Buch.</p>
                  <p>Das Hemd <strong>gef√§llt</strong> mir.</p>
                  <p>Ich fahre <strong>mit</strong> dem Bus.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <table class="grammar-table">
                  <tr><th></th><th>der</th><th>die</th><th>das</th><th>plural</th></tr>
                  <tr><td><strong>Dative</strong></td><td>dem</td><td>der</td><td>dem</td><td>den (+n)</td></tr>
                </table>
                <div class="example-box">
                  <p><strong>Dative verbs:</strong> helfen, danken, gefallen, geh√∂ren, antworten, passen, zuh√∂ren</p>
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-subordinate" data-level="A2" data-tags="subordinate clause weil dass wenn verb final word order comma">
              <div class="topic-head">
                <h4 class="topic-title">Subordinate Clauses: dass / weil / wenn (Verb at the End)</h4>
                <div class="topic-meta">
                  <span class="tag">A2</span>
                  <span class="tag">Word order</span>
                </div>
              </div>
              <p class="topic-summary">
                In subordinate clauses, the conjugated verb goes to the end. The main clause stays V2.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Ich denke, <strong>dass</strong> er heute <strong>kommt</strong>.</p>
                  <p>Ich bleibe zu Hause, <strong>weil</strong> ich krank <strong>bin</strong>.</p>
                  <p><strong>Wenn</strong> es regnet, <strong>bleibe</strong> ich zu Hause.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Comma:</strong> subordinate clauses are normally separated by a comma in German.
                </div>
              </details>
            </article>

            <!-- B1 -->
            <article class="topic-card topic" id="t-relative" data-level="B1" data-tags="relative clauses relativsatz der die das den dem whose dessen deren">
              <div class="topic-head">
                <h4 class="topic-title">Relative Clauses (Relativs√§tze)</h4>
                <div class="topic-meta">
                  <span class="tag">B1</span>
                  <span class="tag">Clauses</span>
                </div>
              </div>
              <p class="topic-summary">
                Relative pronoun gender/number matches the noun, but the case depends on the pronoun‚Äôs role inside the clause.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Das ist der Mann, <strong>der</strong> hier wohnt.</p>
                  <p>Das ist der Mann, <strong>den</strong> ich kenne.</p>
                  <p>Das ist der Mann, <strong>dem</strong> ich helfe.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Shortcut:</strong> Ask what the pronoun does in the relative clause: subject (Nom), object (Akk), indirect object (Dat).
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-passive" data-level="B1" data-tags="passive werden partizip II vorgangspassiv von durch">
              <div class="topic-head">
                <h4 class="topic-title">Passive Voice: werden + Partizip II (Vorgangspassiv)</h4>
                <div class="topic-meta">
                  <span class="tag">B1</span>
                  <span class="tag">Voice</span>
                </div>
              </div>
              <p class="topic-summary">
                Passive focuses on the action. Add the agent with <em>von</em> (people) or cause/means with <em>durch</em>.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Die Suppe <strong>wird</strong> (vom Koch) <strong>gekocht</strong>.</p>
                  <p>Viele Probleme werden <strong>durch</strong> Stress verursacht.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="example-box">
                  <p>Perfekt: Die Suppe <strong>ist</strong> gekocht <strong>worden</strong>.</p>
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-konj2" data-level="B1" data-tags="konjunktiv II w√ºrde w√§re h√§tte polite wishes unreal condition">
              <div class="topic-head">
                <h4 class="topic-title">Konjunktiv II: Politeness & Hypotheticals</h4>
                <div class="topic-meta">
                  <span class="tag">B1</span>
                  <span class="tag">Mood</span>
                </div>
              </div>
              <p class="topic-summary">
                Use Konjunktiv II for polite requests, wishes, and unreal situations. Often: <em>w√ºrde + infinitive</em>.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p><strong>K√∂nnten</strong> Sie mir helfen?</p>
                  <p>Wenn ich Zeit <strong>h√§tte</strong>, <strong>w√ºrde</strong> ich reisen.</p>
                  <p>Ich <strong>w√§re</strong> gern dort.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="example-box">
                  <p>Common forms: <strong>w√§re</strong>, <strong>h√§tte</strong>, <strong>k√∂nnte</strong>, <strong>m√ºsste</strong></p>
                </div>
              </details>
            </article>

            <!-- B2 -->
            <article class="topic-card topic" id="t-state-passive" data-level="B2" data-tags="zustandspassiv sein partizip II state vs action">
              <div class="topic-head">
                <h4 class="topic-title">State vs Action Passive: sein + Partizip II</h4>
                <div class="topic-meta">
                  <span class="tag">B2</span>
                  <span class="tag">Voice</span>
                </div>
              </div>
              <p class="topic-summary">
                <em>werden</em> passive = action happening; <em>sein</em> passive = resulting state.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Die T√ºr <strong>wird</strong> ge√∂ffnet. (action)</p>
                  <p>Die T√ºr <strong>ist</strong> ge√∂ffnet. (state)</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Test:</strong> If you can add ‚Äúright now‚Äù, it‚Äôs usually action passive: ‚ÄúDie T√ºr wird gerade ge√∂ffnet.‚Äù
                </div>
              </details>
            </article>

            <article class="topic-card topic" id="t-konj1" data-level="B2" data-tags="konjunktiv I reported speech sei habe werde">
              <div class="topic-head">
                <h4 class="topic-title">Konjunktiv I (Reported Speech)</h4>
                <div class="topic-meta">
                  <span class="tag">B2</span>
                  <span class="tag">Mood</span>
                </div>
              </div>
              <p class="topic-summary">
                Used in news/reporting to distance the speaker from the statement. Especially common with <em>sein/haben/werden</em>.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p>Er sagt, er <strong>sei</strong> krank.</p>
                  <p>Sie behauptet, sie <strong>habe</strong> nichts gesehen.</p>
                  <p>Der Sprecher erkl√§rte, die Lage <strong>werde</strong> sich verbessern.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="example-box">
                  <p>Alternative: Er sagte, dass er krank <strong>ist</strong>. / Er sagte, er <strong>w√§re</strong> krank. (K II distancing)</p>
                </div>
              </details>
            </article>

            <!-- C1 -->
            <article class="topic-card topic" id="t-nominalization" data-level="C1" data-tags="nominalization nominalstil akademisch -ung -keit -tion">
              <div class="topic-head">
                <h4 class="topic-title">Nominalization (Nominalstil) in Formal German</h4>
                <div class="topic-meta">
                  <span class="tag">C1</span>
                  <span class="tag">Style</span>
                </div>
              </div>
              <p class="topic-summary">
                Formal writing often turns actions into nouns (Analyse der Entwicklung), increasing density and abstraction.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p><strong>Verb style:</strong> Wir analysieren, wie sich der Markt entwickelt.</p>
                  <p><strong>Nominal style:</strong> Wir f√ºhren eine Analyse der Marktentwicklung durch.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="example-box">
                  <p>entwickeln ‚Üí Entwicklung, m√∂glich ‚Üí M√∂glichkeit, informieren ‚Üí Information</p>
                  <p>eine Entscheidung treffen, eine Untersuchung durchf√ºhren</p>
                </div>
              </details>
            </article>

            <!-- C2 -->
            <article class="topic-card topic" id="t-idioms" data-level="C2" data-tags="je desto es sei denn geschweige denn nicht nur sondern auch">
              <div class="topic-head">
                <h4 class="topic-title">C2 Patterns: Fixed Structures for Precision</h4>
                <div class="topic-meta">
                  <span class="tag">C2</span>
                  <span class="tag">Patterns</span>
                </div>
              </div>
              <p class="topic-summary">
                Near-native control includes idiomatic structures that package logic elegantly.
              </p>

              <details class="examples" open>
                <summary>Examples</summary>
                <div class="example-box">
                  <p><strong>Je</strong> mehr ich lerne, <strong>desto</strong> besser werde ich.</p>
                  <p>Ich komme, <strong>es sei denn</strong>, ich bin krank.</p>
                  <p>Er hat es nicht erkl√§rt, <strong>geschweige denn</strong> bewiesen.</p>
                  <p><strong>Nicht nur</strong> ist er p√ºnktlich, <strong>sondern</strong> auch sehr zuverl√§ssig.</p>
                </div>
              </details>

              <details class="deepdive">
                <summary>Deep dive</summary>
                <div class="tip-box">
                  <strong>Goal:</strong> use these without ‚Äúthinking about the grammar‚Äù ‚Äî they become templates.
                </div>
              </details>
            </article>

          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="main-footer">
    <div class="container">
      <p>&copy; 2026 German Verbs Learning App | Built with ‚ù§Ô∏è for language learners</p>
      <div class="footer-links">
        <a href="#" onclick="alert('Created to help learners master German grammar from A1 to C2!'); return false;">About</a>
        <a href="#" onclick="alert('Contact: support@germanverbs.app'); return false;">Contact</a>
      </div>
    </div>
  </footer>

  <script>
    (function(){
      const app = document.getElementById('grammarApp');
      const grid = document.getElementById('topicGrid');
      const topics = Array.from(document.querySelectorAll('.topic'));
      const searchBox = document.getElementById('searchBox');
      const levelSelect = document.getElementById('levelSelect');
      const levelPills = document.getElementById('levelPills');
      const topicLinks = document.getElementById('topicLinks');
      const emptyState = document.getElementById('emptyState');

      const toggleExamples = document.getElementById('toggleExamples');
      const toggleDetails = document.getElementById('toggleDetails');
      const resetBtn = document.getElementById('resetBtn');

      const levels = ["A1","A2","B1","B2","C1","C2"];
      const levelRank = (lvl) => lvl === "ALL" ? -1 : levels.indexOf(lvl);

      function buildSidebarLinks(){
        // Build a simple list of currently visible topics (updated after filtering)
        const visible = topics.filter(t => !t.hidden);
        topicLinks.innerHTML = visible.length
          ? visible.map(t => {
              const title = t.querySelector('.topic-title')?.textContent?.trim() || "Topic";
              const lvl = t.dataset.level || "";
              return `<a href="#${t.id}"><span class="muted">${lvl}</span> ‚Äî ${title}</a>`;
            }).join('')
          : `<div class="muted" style="padding:.35rem .5rem;">No topics to show.</div>`;
      }

      function setActivePill(level){
        Array.from(levelPills.querySelectorAll('.pill')).forEach(p => {
          p.classList.toggle('active', p.dataset.level === level);
        });
      }

      function applyFilters(){
        const q = (searchBox.value || "").trim().toLowerCase();
        const lvl = levelSelect.value;

        const minRank = levelRank(lvl);

        let shown = 0;
        topics.forEach(t => {
          const tLevel = t.dataset.level || "A1";
          const tRank = levelRank(tLevel);
          const text = (
            (t.querySelector('.topic-title')?.textContent || "") + " " +
            (t.querySelector('.topic-summary')?.textContent || "") + " " +
            (t.dataset.tags || "")
          ).toLowerCase();

          const matchesLevel = (lvl === "ALL") ? true : (tRank >= minRank);
          const matchesSearch = q ? text.includes(q) : true;

          const show = matchesLevel && matchesSearch;
          t.hidden = !show;
          if (show) shown++;
        });

        emptyState.style.display = shown ? "none" : "block";
        buildSidebarLinks();
      }

      // Pills click => update select + filter
      levelPills.addEventListener('click', (e) => {
        const pill = e.target.closest('.pill');
        if(!pill) return;
        const lvl = pill.dataset.level;
        levelSelect.value = lvl;
        setActivePill(lvl);
        applyFilters();
      });

      // Select change => update pills + filter
      levelSelect.addEventListener('change', () => {
        setActivePill(levelSelect.value);
        applyFilters();
      });

      // Search
      searchBox.addEventListener('input', applyFilters);

      // Toggles: hide/show examples/deep dives
      toggleExamples.addEventListener('change', () => {
        app.classList.toggle('hide-examples', toggleExamples.checked);
      });
      toggleDetails.addEventListener('change', () => {
        app.classList.toggle('hide-details', toggleDetails.checked);
      });

      resetBtn.addEventListener('click', () => {
        searchBox.value = "";
        levelSelect.value = "ALL";
        setActivePill("ALL");
        toggleExamples.checked = false;
        toggleDetails.checked = false;
        app.classList.remove('hide-examples','hide-details');
        applyFilters();
      });

      // Initial
      applyFilters();
    })();
  </script>
</body>
</html>
